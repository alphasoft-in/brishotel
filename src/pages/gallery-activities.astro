---
import CallToAction from "../components/shared/CTA.astro";
import Footer from "../components/ui/Footer.astro";
import InstagramFeed from "../components/shared/InstagramGallery.astro";
import Navbar from "../components/ui/Navbar.astro";
import Layout from "../layouts/Layout.astro";

// Cargar todas las imágenes de la carpeta activities
const images = import.meta.glob(
    "../assets/images/activities/*.{png,jpg,jpeg}",
    { eager: true, import: "default" },
);

// Convertir a array y ordenar
const activitiesImages = Object.entries(images)
    .map(([path, image]: [string, any]) => ({
        src: image.src,
        alt: "Actividades",
        filename: path.split("/").pop() || "",
    }))
    .sort((a, b) => {
        // Ordenar numéricamente (activities.png, activities-1.png, activities-2.png, etc.)
        const getNumber = (filename: string) => {
            const match = filename.match(/activities-?(\d+)?\.png/);
            return match?.[1] ? parseInt(match[1]) : -1;
        };
        return getNumber(a.filename) - getNumber(b.filename);
    });
---

<Layout>
    <Navbar />
    <section id="gallery" class="bg-[#f7efef] pt-32 pb-16 scroll-mt-32">
        <div class="max-w-6xl mx-auto px-4 text-center">
            <!-- Título -->
            <h2
                class="font-kestrel text-4xl md:text-5xl tracking-wide text-[#3e2f2a]"
            >
                Galería
            </h2>
            <p class="merriweather text-[#8b6f68] text-lg md:text-xl mt-1">
                Habitaciones, restaurante y ambiente.
            </p>

            <!-- Tabs -->
            <div
                class="flex justify-center gap-6 mt-8 text-sm font-semibold text-[#3e2f2a]"
            >
                <button class="border-b-2 border-[#3e2f2a] pb-1"
                    >Amenidades</button
                >
            </div>

            <!-- Galería -->
            <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 mt-10">
                {
                    activitiesImages.map(({ src, alt }) => (
                        <img
                            src={src}
                            alt={alt}
                            class="rounded-lg shadow-md object-cover w-full h-[300px] sm:h-[350px]"
                        />
                    ))
                }
            </div>
        </div>
    </section>
    <InstagramFeed />
    <CallToAction />
    <Footer />
</Layout>
